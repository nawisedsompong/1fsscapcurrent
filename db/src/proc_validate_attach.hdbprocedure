PROCEDURE "proc_validate_attach"( out LT_VAR_OUT TABLE(
		CLAIM_REFERENCE VARCHAR(50),
		CLAIM_CODE VARCHAR(50),
		COMPANY VARCHAR(50)
),
IN LT_CLAIM_TABLE TABLE(
		CLAIM_REFERENCE VARCHAR(50),
		CLAIM_CODE VARCHAR(50),
		COMPANY VARCHAR(50)
)
)
   LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   --DEFAULT SCHEMA <default_schema_name>
 AS
BEGIN
		DECLARE IDX INT;
		DECLARE MAXIDX INT;
		DECLARE LT_EMP_ID VARCHAR(50);
		DECLARE LT_ON_BEH VARCHAR(50);
		LT_VAR_OUT = SELECT	"CLAIM_REFERENCE",
							"CLAIM_CODE",
							"COMPANY"
					FROM
					(SELECT	* FROM (
									SELECT 
												CT."CLAIM_CODE",
												CT."CLAIM_REFERENCE",
												CASE WHEN UPLOAD."FILEID" IS NULL 
												and CLAIMAD."ATTACHMENT_ALLOWED" = 'Required' 
												THEN 'X' ELSE 'Y' END AS ISATTACH,
												CT."COMPANY"
											FROM  :LT_CLAIM_TABLE CT
											LEFT JOIN "SAP_POC_UPLOAD_FILEITEMS" UPLOAD
											ON UPLOAD."FILEID" = CT."CLAIM_REFERENCE"
											LEFT JOIN "BENEFIT_BENEFIT_CLAIM_ADMIN" CLAIMAD
											ON CLAIMAD."CLAIM_CODE" = CT."CLAIM_CODE"
											AND CLAIMAD."COMPANY" = CT."COMPANY"
											AND CLAIMAD."START_DATE"<= CURRENT_DATE
											AND CLAIMAD."END_DATE">= CURRENT_DATE
					) WHERE ISATTACH ='X');
		-- LT_VAR_OUT :='s'; 
	
END